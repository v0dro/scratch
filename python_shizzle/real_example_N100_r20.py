import numpy as np
from scipy.linalg import lu, solve_triangular

np.set_printoptions(linewidth=500, suppress=True, precision=3)

Uc_U = np.array([[0.00368981,0.00502524,0.00163744,-0.0218115,0.00771408,-0.0315887,-0.102671,-0.210815,-0.179979,-0.343894,0.293514,0.271801,0.37657,-0.325885,-0.362281,0.252998,0.266376,-0.206878,0.193679,-0.128454,0.114773,-0.0799892,-0.0453062,0.0102798,0.00108608],
                 [-0.0210975,-0.0164365,0.00712284,0.0874406,-0.0511895,-0.0329049,-0.106155,-0.210716,-0.172773,-0.296349,0.214649,0.166754,0.159156,-0.0535599,0.0611619,-0.135813,-0.24249,0.283322,-0.367676,0.322466,-0.360806,0.331366,0.257137,-0.0643505,-0.0422904],
                 [0.0502019,0.0109236,-0.0751197,-0.047823,0.124754,-0.0343354,-0.109879,-0.210207,-0.164495,-0.247466,0.138752,0.0721184,-0.0108666,0.122007,0.251553,-0.237184,-0.26674,0.185123,-0.0871402,-0.050478,0.202116,-0.393099,-0.532264,0.187265,0.199559],
                 [-0.0590507,-0.00471633,0.174673,-0.259203,-0.0856376,-0.0358961,-0.113867,-0.20921,-0.155003,-0.197448,0.0668747,-0.0103254,-0.132879,0.210316,0.270218,-0.164575,-0.077513,-0.0663096,0.220152,-0.255851,0.275582,-0.058755,0.382082,-0.358622,-0.3543],
                 [0.0190614,0.0446914,-0.0736316,0.425479,-0.168135,-0.0376053,-0.118147,-0.207628,-0.144138,-0.146571,0.000233737,-0.0787207,-0.207381,0.223908,0.178501,-0.0177163,0.129702,-0.224064,0.25783,-0.125417,-0.0522673,0.253381,0.169878,0.516037,0.198341],
                 [0.0504919,0.00634398,-0.305024,-0.0114859,0.300599,-0.0394855,-0.122751,-0.205346,-0.131716,-0.0952067,-0.0597765,-0.131192,-0.236301,0.178443,0.0348915,0.123218,0.239087,-0.205069,0.0656938,0.125703,-0.27677,0.154083,-0.27965,-0.534248,0.143196],
                 [-0.122375,-0.223944,0.502389,-0.332492,0.106262,-0.0415636,-0.127715,-0.202225,-0.117532,-0.0438454,-0.111575,-0.16594,-0.223329,0.0925304,-0.108474,0.203078,0.21184,-0.0493401,-0.165472,0.238784,-0.158548,-0.0882776,-0.104921,0.341601,-0.205418],
                 [0.208766,0.196948,-0.14855,0.0279469,-0.629604,-0.0438725,-0.13308,-0.198094,-0.101354,0.0068705,-0.153397,-0.181385,-0.174277,-0.0127723,-0.209793,0.195955,0.075035,0.134639,-0.255618,0.120497,0.133565,-0.307029,0.093254,-0.143313,0.121837],
                 [-0.232361,0.204845,-0.360209,0.109467,0.485794,-0.0464531,-0.138892,-0.192743,-0.0829252,0.0561075,-0.183316,-0.176378,-0.0974168,-0.114983,-0.241791,0.106902,-0.0990732,0.231968,-0.143689,-0.113898,0.265161,0.021754,0.203857,0.172492,-0.24706],
                 [-0.0157283,-0.294101,0.475174,0.346462,0.0416369,-0.0493563,-0.145206,-0.185914,-0.0619646,0.102792,-0.199292,-0.150502,-0.00372163,-0.191902,-0.195577,-0.0303952,-0.222802,0.179209,0.0827999,-0.244958,0.101229,0.160928,-0.0942781,-0.271113,0.296093],
                 [0.475546,-0.0780483,-0.217004,-0.468252,-0.0804776,-0.0526465,-0.152081,-0.177288,-0.0381748,0.145546,-0.199277,-0.104501,0.0930853,-0.224196,-0.083254,-0.161733,-0.228543,0.00155599,0.245919,-0.136977,-0.19024,0.243679,-0.0635047,0.191152,-0.0685515],
                 [-0.658224,0.0860839,-0.104467,0.030126,-0.268301,-0.0564066,-0.159584,-0.166465,-0.0112565,0.18262,-0.181396,-0.0408563,0.176882,-0.199003,0.0621137,-0.227617,-0.102503,-0.189306,0.201334,0.125169,-0.250154,-0.166285,-0.142448,-0.0312071,-0.102555],
                 [0.316319,0.396291,0.273083,0.0960377,0.318576,-0.0607453,-0.16779,-0.152942,0.0190613,0.211796,-0.144262,0.0354578,0.230188,-0.114494,0.191041,-0.185567,0.0959973,-0.249557,-0.0346077,0.269305,0.0157189,-0.246227,0.255945,-0.0196807,0.161456],
                 [0.144123,-0.531584,-0.200261,0.239757,-0.0736908,-0.065807,-0.176776,-0.136083,0.0529635,0.230306,-0.0874906,0.116051,0.236331,0.0151326,0.24886,-0.0360803,0.246394,-0.102724,-0.253205,0.0911368,0.279201,0.0626151,-0.104492,-0.0109542,-0.326577],
                 [-0.277339,0.0817751,-0.0167258,-0.401125,-0.032137,-0.0717889,-0.186617,-0.11508,0.0904403,0.23474,-0.0125297,0.188136,0.18334,0.155697,0.195296,0.157287,0.224605,0.16225,-0.201858,-0.241652,0.112847,0.243005,0.0857089,0.0288823,0.474878],
                 [0.138343,0.346761,0.16566,0.215509,-0.0522866,-0.0789671,-0.197372,-0.0888965,0.131086,0.221018,0.0760433,0.233835,0.0701997,0.253399,0.0314358,0.272387,0.0031872,0.290685,0.121077,-0.239911,-0.287915,-0.00916913,-0.252331,-0.024286,-0.395123],
                 [-0.0013687,-0.385474,-0.162114,-0.00786416,0.112955,-0.0877402,-0.209052,-0.0562095,0.173718,0.184516,0.168568,0.230677,-0.0842425,0.245602,-0.173894,0.184179,-0.256541,0.0675488,0.304346,0.218329,-0.111082,-0.348659,0.316061,0.0170449,0.188571],
                 [-0.0335272,0.213973,0.0876563,-0.0509435,-0.0843918,-0.0987063,-0.221557,-0.0153353,0.215657,0.12058,0.247553,0.15538,-0.231139,0.0913703,-0.280943,-0.110704,-0.247082,-0.310964,-0.0455501,0.284747,0.38985,0.369725,-0.213007,-0.0106135,-0.0461039],
                 [0.0193651,-0.0736157,-0.030184,0.0304496,0.0353928,-0.112805,-0.234521,0.0358156,0.251318,0.0260126,0.28442,-0.00452562,-0.287025,-0.169853,-0.143814,-0.351211,0.1483,-0.181987,-0.364763,-0.450441,-0.293909,-0.192054,0.0879585,0.00484241,0.00077334],
                 [-0.00574601,0.0164089,0.00679347,-0.00911885,-0.00918301,-0.131603,-0.246962,0.0996539,0.269413,-0.0971161,0.237726,-0.222622,-0.155458,-0.345962,0.204556,-0.0958486,0.353736,0.455342,0.335203,0.257703,0.114098,0.058848,-0.0231823,-0.00145099,0.00296123],
                 [0.00100875,-0.00234402,-0.000980622,0.00159973,0.0014869,-0.157918,-0.256388,0.178322,0.247286,-0.231982,0.0610196,-0.378225,0.175163,-0.118108,0.313528,0.492119,-0.365211,-0.269858,-0.132843,-0.077618,-0.0254927,-0.0109773,0.00387207,0.000271134,-0.000882278],
                 [-0.000103901,0.000203847,8.57798e-05,-0.000163749,-0.000143986,-0.197388,-0.256258,0.271194,0.139763,-0.323706,-0.250365,-0.194391,0.387972,0.469089,-0.337172,-0.297177,0.134786,0.0734387,0.0270115,0.0128763,0.00325344,0.00120648,-0.000390778,-2.97889e-05,0.000119676],
                 [5.75149e-06,-9.71297e-06,-4.07082e-06,8.97875e-06,7.53289e-06,-0.263162,-0.227511,0.364411,-0.137297,-0.226123,-0.477242,0.545046,-0.296213,-0.21732,0.104824,0.0695243,-0.0219277,-0.00952423,-0.00273541,-0.001104,-0.00021791,-7.09854e-05,2.1503e-05,1.73051e-06,-7.95578e-06],
                 [-1.39333e-07,2.04697e-07,8.39997e-08,-2.15045e-07,-1.71916e-07,-0.394677,-0.101573,0.378214,-0.656583,0.347188,0.319246,-0.181739,0.0560036,0.0312121,-0.0113377,-0.00615233,0.0014022,0.000504508,0.000115541,4.04012e-05,6.24864e-06,1.81297e-06,-5.2144e-07,-4.28026e-08,2.20374e-07],
                 [8.53569e-10,-1.09793e-09,-4.28635e-10,1.30099e-09,9.81061e-10,-0.788961,0.515447,-0.260925,0.201404,-0.0459005,-0.0310654,0.0115414,-0.0021446,-0.000973889,0.000278142,0.000128621,-2.12818e-05,-6.48912e-06,-1.19602e-06,-3.68111e-07,-4.43102e-08,-1.15671e-08,3.20388e-09,2.57015e-10,-1.49214e-09]])
Vc_V = np.array([[0.00368981,0.00502524,0.00163744,-0.0218115,0.00771408,-0.0315887,-0.102671,-0.210815,-0.179979,-0.343894,0.293514,0.271801,0.37657,-0.325885,-0.362281,0.252998,0.266376,-0.206878,0.193679,-0.128454,0.114773,-0.0799892,-0.0453062,0.0102798,0.00108608],
                 [-0.0210975,-0.0164365,0.00712284,0.0874406,-0.0511895,-0.0329049,-0.106155,-0.210716,-0.172773,-0.296349,0.214649,0.166754,0.159156,-0.0535599,0.0611619,-0.135813,-0.24249,0.283322,-0.367676,0.322466,-0.360806,0.331366,0.257137,-0.0643505,-0.0422904],
                 [0.0502019,0.0109236,-0.0751197,-0.047823,0.124754,-0.0343354,-0.109879,-0.210207,-0.164495,-0.247466,0.138752,0.0721184,-0.0108666,0.122007,0.251553,-0.237184,-0.26674,0.185123,-0.0871402,-0.050478,0.202116,-0.393099,-0.532264,0.187265,0.199559],
                 [-0.0590507,-0.00471633,0.174673,-0.259203,-0.0856376,-0.0358961,-0.113867,-0.20921,-0.155003,-0.197448,0.0668747,-0.0103254,-0.132879,0.210316,0.270218,-0.164575,-0.077513,-0.0663096,0.220152,-0.255851,0.275582,-0.058755,0.382082,-0.358622,-0.3543],
                 [0.0190614,0.0446914,-0.0736316,0.425479,-0.168135,-0.0376053,-0.118147,-0.207628,-0.144138,-0.146571,0.000233737,-0.0787207,-0.207381,0.223908,0.178501,-0.0177163,0.129702,-0.224064,0.25783,-0.125417,-0.0522673,0.253381,0.169878,0.516037,0.198341],
                 [0.0504919,0.00634398,-0.305024,-0.0114859,0.300599,-0.0394855,-0.122751,-0.205346,-0.131716,-0.0952067,-0.0597765,-0.131192,-0.236301,0.178443,0.0348915,0.123218,0.239087,-0.205069,0.0656938,0.125703,-0.27677,0.154083,-0.27965,-0.534248,0.143196],
                 [-0.122375,-0.223944,0.502389,-0.332492,0.106262,-0.0415636,-0.127715,-0.202225,-0.117532,-0.0438454,-0.111575,-0.16594,-0.223329,0.0925304,-0.108474,0.203078,0.21184,-0.0493401,-0.165472,0.238784,-0.158548,-0.0882776,-0.104921,0.341601,-0.205418],
                 [0.208766,0.196948,-0.14855,0.0279469,-0.629604,-0.0438725,-0.13308,-0.198094,-0.101354,0.0068705,-0.153397,-0.181385,-0.174277,-0.0127723,-0.209793,0.195955,0.075035,0.134639,-0.255618,0.120497,0.133565,-0.307029,0.093254,-0.143313,0.121837],
                 [-0.232361,0.204845,-0.360209,0.109467,0.485794,-0.0464531,-0.138892,-0.192743,-0.0829252,0.0561075,-0.183316,-0.176378,-0.0974168,-0.114983,-0.241791,0.106902,-0.0990732,0.231968,-0.143689,-0.113898,0.265161,0.021754,0.203857,0.172492,-0.24706],
                 [-0.0157283,-0.294101,0.475174,0.346462,0.0416369,-0.0493563,-0.145206,-0.185914,-0.0619646,0.102792,-0.199292,-0.150502,-0.00372163,-0.191902,-0.195577,-0.0303952,-0.222802,0.179209,0.0827999,-0.244958,0.101229,0.160928,-0.0942781,-0.271113,0.296093],
                 [0.475546,-0.0780483,-0.217004,-0.468252,-0.0804776,-0.0526465,-0.152081,-0.177288,-0.0381748,0.145546,-0.199277,-0.104501,0.0930853,-0.224196,-0.083254,-0.161733,-0.228543,0.00155599,0.245919,-0.136977,-0.19024,0.243679,-0.0635047,0.191152,-0.0685515],
                 [-0.658224,0.0860839,-0.104467,0.030126,-0.268301,-0.0564066,-0.159584,-0.166465,-0.0112565,0.18262,-0.181396,-0.0408563,0.176882,-0.199003,0.0621137,-0.227617,-0.102503,-0.189306,0.201334,0.125169,-0.250154,-0.166285,-0.142448,-0.0312071,-0.102555],
                 [0.316319,0.396291,0.273083,0.0960377,0.318576,-0.0607453,-0.16779,-0.152942,0.0190613,0.211796,-0.144262,0.0354578,0.230188,-0.114494,0.191041,-0.185567,0.0959973,-0.249557,-0.0346077,0.269305,0.0157189,-0.246227,0.255945,-0.0196807,0.161456],
                 [0.144123,-0.531584,-0.200261,0.239757,-0.0736908,-0.065807,-0.176776,-0.136083,0.0529635,0.230306,-0.0874906,0.116051,0.236331,0.0151326,0.24886,-0.0360803,0.246394,-0.102724,-0.253205,0.0911368,0.279201,0.0626151,-0.104492,-0.0109542,-0.326577],
                 [-0.277339,0.0817751,-0.0167258,-0.401125,-0.032137,-0.0717889,-0.186617,-0.11508,0.0904403,0.23474,-0.0125297,0.188136,0.18334,0.155697,0.195296,0.157287,0.224605,0.16225,-0.201858,-0.241652,0.112847,0.243005,0.0857089,0.0288823,0.474878],
                 [0.138343,0.346761,0.16566,0.215509,-0.0522866,-0.0789671,-0.197372,-0.0888965,0.131086,0.221018,0.0760433,0.233835,0.0701997,0.253399,0.0314358,0.272387,0.0031872,0.290685,0.121077,-0.239911,-0.287915,-0.00916913,-0.252331,-0.024286,-0.395123],
                 [-0.0013687,-0.385474,-0.162114,-0.00786416,0.112955,-0.0877402,-0.209052,-0.0562095,0.173718,0.184516,0.168568,0.230677,-0.0842425,0.245602,-0.173894,0.184179,-0.256541,0.0675488,0.304346,0.218329,-0.111082,-0.348659,0.316061,0.0170449,0.188571],
                 [-0.0335272,0.213973,0.0876563,-0.0509435,-0.0843918,-0.0987063,-0.221557,-0.0153353,0.215657,0.12058,0.247553,0.15538,-0.231139,0.0913703,-0.280943,-0.110704,-0.247082,-0.310964,-0.0455501,0.284747,0.38985,0.369725,-0.213007,-0.0106135,-0.0461039],
                 [0.0193651,-0.0736157,-0.030184,0.0304496,0.0353928,-0.112805,-0.234521,0.0358156,0.251318,0.0260126,0.28442,-0.00452562,-0.287025,-0.169853,-0.143814,-0.351211,0.1483,-0.181987,-0.364763,-0.450441,-0.293909,-0.192054,0.0879585,0.00484241,0.00077334],
                 [-0.00574601,0.0164089,0.00679347,-0.00911885,-0.00918301,-0.131603,-0.246962,0.0996539,0.269413,-0.0971161,0.237726,-0.222622,-0.155458,-0.345962,0.204556,-0.0958486,0.353736,0.455342,0.335203,0.257703,0.114098,0.058848,-0.0231823,-0.00145099,0.00296123],
                 [0.00100875,-0.00234402,-0.000980622,0.00159973,0.0014869,-0.157918,-0.256388,0.178322,0.247286,-0.231982,0.0610196,-0.378225,0.175163,-0.118108,0.313528,0.492119,-0.365211,-0.269858,-0.132843,-0.077618,-0.0254927,-0.0109773,0.00387207,0.000271134,-0.000882278],
                 [-0.000103901,0.000203847,8.57798e-05,-0.000163749,-0.000143986,-0.197388,-0.256258,0.271194,0.139763,-0.323706,-0.250365,-0.194391,0.387972,0.469089,-0.337172,-0.297177,0.134786,0.0734387,0.0270115,0.0128763,0.00325344,0.00120648,-0.000390778,-2.97889e-05,0.000119676],
                 [5.75149e-06,-9.71297e-06,-4.07082e-06,8.97875e-06,7.53289e-06,-0.263162,-0.227511,0.364411,-0.137297,-0.226123,-0.477242,0.545046,-0.296213,-0.21732,0.104824,0.0695243,-0.0219277,-0.00952423,-0.00273541,-0.001104,-0.00021791,-7.09854e-05,2.1503e-05,1.73051e-06,-7.95578e-06],
                 [-1.39333e-07,2.04697e-07,8.39997e-08,-2.15045e-07,-1.71916e-07,-0.394677,-0.101573,0.378214,-0.656583,0.347188,0.319246,-0.181739,0.0560036,0.0312121,-0.0113377,-0.00615233,0.0014022,0.000504508,0.000115541,4.04012e-05,6.24864e-06,1.81297e-06,-5.2144e-07,-4.28026e-08,2.20374e-07],
                 [8.53569e-10,-1.09793e-09,-4.28635e-10,1.30099e-09,9.81061e-10,-0.788961,0.515447,-0.260925,0.201404,-0.0459005,-0.0310654,0.0115414,-0.0021446,-0.000973889,0.000278142,0.000128621,-2.12818e-05,-6.48912e-06,-1.19602e-06,-3.68111e-07,-4.43102e-08,-1.15671e-08,3.20388e-09,2.57015e-10,-1.49214e-09]])
matrix = np.array([[1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168,0.0454525,0.0434764,0.0416649],
                   [0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168,0.0454525,0.0434764],
                   [0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168,0.0454525],
                   [0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168],
                   [0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975],
                   [0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288],
                   [0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525],
                   [0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201],
                   [0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961],
                   [0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622],
                   [0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235],
                   [0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172],
                   [0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264],
                   [0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008],
                   [0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999],
                   [0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099],
                   [0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984],
                   [0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837],
                   [0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639],
                   [0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996],
                   [0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938],
                   [0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222],
                   [0.0454525,0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975],
                   [0.0434764,0.0454525,0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001],
                   [0.0416649,0.0434764,0.0454525,0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000]])

b = np.array([
    180428.94,
    84693.09  ,
    168169.28 ,
    171463.69 ,
    195774.78 ,
    42423.83  ,
    71988.54  ,
    164976.05 ,
    59651.66  ,
    118964.14 ,
    102520.24 ,
    135049.00 ,
    78336.87  ,
    110252.01 ,
    204489.78 ,
    196751.39 ,
    136518.05 ,
    154038.34 ,
    30408.92  ,
    130345.57 ,
    3500.52  ,
    52159.54  ,
    29470.26  ,
    172695.64 ,
    33646.58]).reshape(25,1)

print(Uc_U.T.dot(Vc_V))
print(np.linalg.solve(matrix, b))

N = 25
rank = 20
leftover = N - rank

# new_mat = matrix
new_mat = Uc_U.T.dot(matrix).dot(Vc_V)

p, Loo, Uoo = lu(new_mat[:leftover, :leftover], overwrite_a=True)
print(p)
new_mat[:leftover, leftover:] -= solve_triangular(Loo, new_mat[:leftover, leftover:], lower=True)
new_mat[leftover:, :leftover] -= solve_triangular(Uoo, new_mat[leftover:, :leftover].T, lower=False).T
new_mat[leftover:, leftover:] -= new_mat[leftover:, :leftover].dot(new_mat[:leftover, leftover:])

y = Uc_U.T.dot(b)
# y = b
y[:leftover] = solve_triangular(Loo, y[:leftover], lower=True)
y[leftover:] -= new_mat[leftover:, :leftover].dot(y[:leftover])
# y = piv.dot(y)

# y = piv.T.dot(y)
y = Vc_V.dot(y)
y[:leftover] -= new_mat[:leftover, leftover:].dot(y[leftover:])
y[:leftover] = solve_triangular(Uoo, y[:leftover], lower=False)

print("from trisolve:")
print(y)

