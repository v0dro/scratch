import numpy as np
from scipy.linalg import lu, solve_triangular

np.set_printoptions(linewidth=500, suppress=True, precision=3)

Uc_U = np.array([[-0.0230337,0.0111042,0.0603048,0.108525,0.137524,0.133975,0.0985874,0.052835,0.0326873,0.0531735,0.0458238,-0.107651,-0.0780064,-0.102887,-0.392919,-0.0315887,-0.102671,-0.210815,-0.179979,-0.343894,0.293514,0.271801,0.37657,-0.325885,-0.362281],
                 [-0.0372904,-0.0705058,-0.103402,-0.129652,-0.144756,-0.148439,-0.146775,-0.151931,-0.175516,-0.211141,-0.21295,-0.12808,-0.112235,0.0329665,0.66892,-0.0329049,-0.106155,-0.210716,-0.172773,-0.296349,0.214649,0.166754,0.159156,-0.0535599,0.0611619],
                 [-0.00818795,-0.050767,-0.101037,-0.142598,-0.15894,-0.139413,-0.0862191,-0.0183357,0.0366424,0.0751842,0.168371,0.414071,0.470318,0.433089,-0.224293,-0.0343354,-0.109879,-0.210207,-0.164495,-0.247466,0.138752,0.0721184,-0.0108666,0.122007,0.251553],
                 [0.0947139,0.0895334,0.0720766,0.0537212,0.04752,0.0639222,0.105097,0.160152,0.206857,0.227982,0.238288,0.245446,-0.0665391,-0.649712,0.181738,-0.0358961,-0.113867,-0.20921,-0.155003,-0.197448,0.0668747,-0.0103254,-0.132879,0.210316,0.270218],
                 [0.245977,0.29587,0.321574,0.318156,0.283752,0.221086,0.138569,0.0498246,-0.0302951,-0.0948242,-0.15396,-0.211289,-0.118164,0.414179,0.0232032,-0.0376053,-0.118147,-0.207628,-0.144138,-0.146571,0.000233737,-0.0787207,-0.207381,0.223908,0.178501],
                 [-0.17345,-0.198967,-0.226803,-0.241391,-0.22413,-0.159437,-0.0447279,0.0965821,0.20439,0.188437,-0.0199754,-0.350324,-0.497587,0.118381,-0.277,-0.0394855,-0.122751,-0.205346,-0.131716,-0.0952067,-0.0597765,-0.131192,-0.236301,0.178443,0.0348915],
                 [-0.114379,-0.0780817,-0.0471754,-0.0226398,-0.00419162,0.00794773,0.00953436,-0.0126618,-0.0835498,-0.226185,-0.394967,-0.305075,0.571136,-0.357289,-0.178409,-0.0415636,-0.127715,-0.202225,-0.117532,-0.0438454,-0.111575,-0.16594,-0.223329,0.0925304,-0.108474],
                 [0.0221717,0.0972471,0.130748,0.10306,0.00479492,-0.15343,-0.330429,-0.449203,-0.41138,-0.157173,0.205459,0.277077,-0.252397,-0.12849,-0.185721,-0.0438725,-0.13308,-0.198094,-0.101354,0.0068705,-0.153397,-0.181385,-0.174277,-0.0127723,-0.209793],
                 [-0.303542,-0.265736,-0.1657,-0.0145095,0.157005,0.29686,0.339829,0.234254,-0.00195662,-0.204787,-0.0652535,0.442485,-0.125108,0.145251,0.182182,-0.0464531,-0.138892,-0.192743,-0.0829252,0.0561075,-0.183316,-0.176378,-0.0974168,-0.114983,-0.241791],
                 [-0.171983,-0.047479,0.0683585,0.130777,0.109082,0.00989687,-0.102028,-0.107217,0.099988,0.435945,0.432284,-0.322235,0.283378,0.148674,0.330731,-0.0493563,-0.145206,-0.185914,-0.0619646,0.102792,-0.199292,-0.150502,-0.00372163,-0.191902,-0.195577],
                 [0.838423,-0.174936,-0.169156,-0.140478,-0.0896272,-0.0244437,0.0382936,0.0744827,0.0624417,0.00574954,-0.0382645,0.0113827,0.0142667,0.00476132,0.015339,-0.0526465,-0.152081,-0.177288,-0.0381748,0.145546,-0.199277,-0.104501,0.0930853,-0.224196,-0.083254],
                 [-0.158689,0.802928,-0.212506,-0.193847,-0.136489,-0.0484966,0.0441622,0.0987221,0.0734334,-0.0262422,-0.0882572,0.0355781,-0.0151147,-0.00321519,-0.0133465,-0.0564066,-0.159584,-0.166465,-0.0112565,0.18262,-0.181396,-0.0408563,0.176882,-0.199003,0.0621137],
                 [-0.135631,-0.195767,0.765455,-0.234639,-0.185554,-0.0922056,0.0169352,0.0892124,0.0685902,-0.0453179,-0.116849,0.0421234,-0.0380122,-0.0161272,-0.0459996,-0.0607453,-0.16779,-0.152942,0.0190613,0.211796,-0.144262,0.0354578,0.230188,-0.114494,0.191041],
                 [-0.0951473,-0.165964,-0.223221,0.752743,-0.223111,-0.149281,-0.0469661,0.0365909,0.0440338,-0.0391385,-0.104417,0.0238628,-0.0449645,-0.0271087,-0.0675622,-0.065807,-0.176776,-0.136083,0.0529635,0.230306,-0.0874906,0.116051,0.236331,0.0151326,0.24886],
                 [-0.0444527,-0.108587,-0.172267,-0.219376,0.765987,-0.206336,-0.140086,-0.0587797,-0.00300902,-0.00602382,-0.0423683,-0.0157626,-0.0310131,-0.0287769,-0.0641031,-0.0717889,-0.186617,-0.11508,0.0904403,0.23474,-0.0125297,0.188136,0.18334,0.155697,0.195296],
                 [0.00467305,-0.0341174,-0.0874873,-0.148936,-0.206553,0.756813,-0.23924,-0.18043,-0.07299,0.0357688,0.0543454,-0.0573706,-0.000611223,-0.0166846,-0.0301998,-0.0789671,-0.197372,-0.0888965,0.131086,0.221018,0.0760433,0.233835,0.0701997,0.253399,0.0314358],
                 [0.0374745,0.0352174,0.00751629,-0.0518518,-0.139546,-0.236472,0.695837,-0.291066,-0.161349,0.0427082,0.136298,-0.0662541,0.0293537,0.00628108,0.0227037,-0.0877402,-0.209052,-0.0562095,0.173718,0.184516,0.168568,0.230677,-0.0842425,0.245602,-0.173894],
                 [0.0409129,0.0685694,0.071515,0.0342821,-0.0498309,-0.169346,-0.286079,0.664317,-0.253278,-0.0436391,0.122002,-0.00929001,0.034012,0.0267163,0.0622799,-0.0987063,-0.221557,-0.0153353,0.215657,0.12058,0.247553,0.15538,-0.231139,0.0913703,-0.280943],
                 [0.0128512,0.041604,0.0620512,0.0608259,0.0254955,-0.0498335,-0.156641,-0.26381,0.68438,-0.250626,-0.0634144,0.0979109,0.000573796,0.0241436,0.0472364,-0.112805,-0.234521,0.0358156,0.251318,0.0260126,0.28442,-0.00452562,-0.287025,-0.169853,-0.143814],
                 [-0.025587,-0.0304622,-0.019848,0.00775197,0.0438599,0.0655552,0.0357232,-0.0834601,-0.291157,0.522063,-0.385611,0.11506,-0.0356705,-0.00997116,-0.0290292,-0.131603,-0.246962,0.0996539,0.269413,-0.0971161,0.237726,-0.222622,-0.155458,-0.345962,0.204556],
                 [-0.0274149,-0.0583028,-0.0703964,-0.0512626,0.00160753,0.0715843,0.115704,0.0689882,-0.121749,-0.414091,0.438463,-0.229897,0.00783714,-0.0357272,-0.0714916,-0.157918,-0.256388,0.178322,0.247286,-0.231982,0.0610196,-0.378225,0.175163,-0.118108,0.313528],
                 [0.0292601,0.0496306,0.0508579,0.0260424,-0.0203925,-0.0668074,-0.0747879,-0.00714226,0.121161,0.159787,-0.18881,0.123543,0.00745149,0.0283836,0.0607445,-0.197388,-0.256258,0.271194,0.139763,-0.323706,-0.250365,-0.194391,0.387972,0.469089,-0.337172],
                 [-0.00850526,-0.0132702,-0.0125721,-0.00506975,0.00726503,0.0179673,0.0171443,-0.00233254,-0.0311569,-0.0298725,0.0365437,-0.0276619,-0.00328063,-0.00754826,-0.016591,-0.263162,-0.227511,0.364411,-0.137297,-0.226123,-0.477242,0.545046,-0.296213,-0.21732,0.104824],
                 [0.000853828,0.00126568,0.00113649,0.0003724,-0.000790322,-0.0017034,-0.00146737,0.000419259,0.00283934,0.00230801,-0.00283462,0.0023978,0.000384293,0.000725069,0.00161984,-0.394677,-0.101573,0.378214,-0.656583,0.347188,0.319246,-0.181739,0.0560036,0.0312121,-0.0113377],
                 [-1.94359e-05,-2.77737e-05,-2.39342e-05,-6.44145e-06,1.8764e-05,3.7076e-05,2.96615e-05,-1.17106e-05,-5.99093e-05,-4.40655e-05,5.35702e-05,-4.961e-05,-9.53326e-06,-1.60841e-05,-3.63513e-05,-0.788961,0.515447,-0.260925,0.201404,-0.0459005,-0.0310654,0.0115414,-0.0021446,-0.000973889,0.000278142]])
Vc_V = np.array([[-0.0230337,0.0111042,0.0603048,0.108525,0.137524,0.133975,0.0985874,0.052835,0.0326873,0.0531735,0.0458238,-0.107651,-0.0780064,-0.102887,-0.392919,-0.0315887,-0.102671,-0.210815,-0.179979,-0.343894,0.293514,0.271801,0.37657,-0.325885,-0.362281],
                 [-0.0372904,-0.0705058,-0.103402,-0.129652,-0.144756,-0.148439,-0.146775,-0.151931,-0.175516,-0.211141,-0.21295,-0.12808,-0.112235,0.0329665,0.66892,-0.0329049,-0.106155,-0.210716,-0.172773,-0.296349,0.214649,0.166754,0.159156,-0.0535599,0.0611619],
                 [-0.00818795,-0.050767,-0.101037,-0.142598,-0.15894,-0.139413,-0.0862191,-0.0183357,0.0366424,0.0751842,0.168371,0.414071,0.470318,0.433089,-0.224293,-0.0343354,-0.109879,-0.210207,-0.164495,-0.247466,0.138752,0.0721184,-0.0108666,0.122007,0.251553],
                 [0.0947139,0.0895334,0.0720766,0.0537212,0.04752,0.0639222,0.105097,0.160152,0.206857,0.227982,0.238288,0.245446,-0.0665391,-0.649712,0.181738,-0.0358961,-0.113867,-0.20921,-0.155003,-0.197448,0.0668747,-0.0103254,-0.132879,0.210316,0.270218],
                 [0.245977,0.29587,0.321574,0.318156,0.283752,0.221086,0.138569,0.0498246,-0.0302951,-0.0948242,-0.15396,-0.211289,-0.118164,0.414179,0.0232032,-0.0376053,-0.118147,-0.207628,-0.144138,-0.146571,0.000233737,-0.0787207,-0.207381,0.223908,0.178501],
                 [-0.17345,-0.198967,-0.226803,-0.241391,-0.22413,-0.159437,-0.0447279,0.0965821,0.20439,0.188437,-0.0199754,-0.350324,-0.497587,0.118381,-0.277,-0.0394855,-0.122751,-0.205346,-0.131716,-0.0952067,-0.0597765,-0.131192,-0.236301,0.178443,0.0348915],
                 [-0.114379,-0.0780817,-0.0471754,-0.0226398,-0.00419162,0.00794773,0.00953436,-0.0126618,-0.0835498,-0.226185,-0.394967,-0.305075,0.571136,-0.357289,-0.178409,-0.0415636,-0.127715,-0.202225,-0.117532,-0.0438454,-0.111575,-0.16594,-0.223329,0.0925304,-0.108474],
                 [0.0221717,0.0972471,0.130748,0.10306,0.00479492,-0.15343,-0.330429,-0.449203,-0.41138,-0.157173,0.205459,0.277077,-0.252397,-0.12849,-0.185721,-0.0438725,-0.13308,-0.198094,-0.101354,0.0068705,-0.153397,-0.181385,-0.174277,-0.0127723,-0.209793],
                 [-0.303542,-0.265736,-0.1657,-0.0145095,0.157005,0.29686,0.339829,0.234254,-0.00195662,-0.204787,-0.0652535,0.442485,-0.125108,0.145251,0.182182,-0.0464531,-0.138892,-0.192743,-0.0829252,0.0561075,-0.183316,-0.176378,-0.0974168,-0.114983,-0.241791],
                 [-0.171983,-0.047479,0.0683585,0.130777,0.109082,0.00989687,-0.102028,-0.107217,0.099988,0.435945,0.432284,-0.322235,0.283378,0.148674,0.330731,-0.0493563,-0.145206,-0.185914,-0.0619646,0.102792,-0.199292,-0.150502,-0.00372163,-0.191902,-0.195577],
                 [0.838423,-0.174936,-0.169156,-0.140478,-0.0896272,-0.0244437,0.0382936,0.0744827,0.0624417,0.00574954,-0.0382645,0.0113827,0.0142667,0.00476132,0.015339,-0.0526465,-0.152081,-0.177288,-0.0381748,0.145546,-0.199277,-0.104501,0.0930853,-0.224196,-0.083254],
                 [-0.158689,0.802928,-0.212506,-0.193847,-0.136489,-0.0484966,0.0441622,0.0987221,0.0734334,-0.0262422,-0.0882572,0.0355781,-0.0151147,-0.00321519,-0.0133465,-0.0564066,-0.159584,-0.166465,-0.0112565,0.18262,-0.181396,-0.0408563,0.176882,-0.199003,0.0621137],
                 [-0.135631,-0.195767,0.765455,-0.234639,-0.185554,-0.0922056,0.0169352,0.0892124,0.0685902,-0.0453179,-0.116849,0.0421234,-0.0380122,-0.0161272,-0.0459996,-0.0607453,-0.16779,-0.152942,0.0190613,0.211796,-0.144262,0.0354578,0.230188,-0.114494,0.191041],
                 [-0.0951473,-0.165964,-0.223221,0.752743,-0.223111,-0.149281,-0.0469661,0.0365909,0.0440338,-0.0391385,-0.104417,0.0238628,-0.0449645,-0.0271087,-0.0675622,-0.065807,-0.176776,-0.136083,0.0529635,0.230306,-0.0874906,0.116051,0.236331,0.0151326,0.24886],
                 [-0.0444527,-0.108587,-0.172267,-0.219376,0.765987,-0.206336,-0.140086,-0.0587797,-0.00300902,-0.00602382,-0.0423683,-0.0157626,-0.0310131,-0.0287769,-0.0641031,-0.0717889,-0.186617,-0.11508,0.0904403,0.23474,-0.0125297,0.188136,0.18334,0.155697,0.195296],
                 [0.00467305,-0.0341174,-0.0874873,-0.148936,-0.206553,0.756813,-0.23924,-0.18043,-0.07299,0.0357688,0.0543454,-0.0573706,-0.000611223,-0.0166846,-0.0301998,-0.0789671,-0.197372,-0.0888965,0.131086,0.221018,0.0760433,0.233835,0.0701997,0.253399,0.0314358],
                 [0.0374745,0.0352174,0.00751629,-0.0518518,-0.139546,-0.236472,0.695837,-0.291066,-0.161349,0.0427082,0.136298,-0.0662541,0.0293537,0.00628108,0.0227037,-0.0877402,-0.209052,-0.0562095,0.173718,0.184516,0.168568,0.230677,-0.0842425,0.245602,-0.173894],
                 [0.0409129,0.0685694,0.071515,0.0342821,-0.0498309,-0.169346,-0.286079,0.664317,-0.253278,-0.0436391,0.122002,-0.00929001,0.034012,0.0267163,0.0622799,-0.0987063,-0.221557,-0.0153353,0.215657,0.12058,0.247553,0.15538,-0.231139,0.0913703,-0.280943],
                 [0.0128512,0.041604,0.0620512,0.0608259,0.0254955,-0.0498335,-0.156641,-0.26381,0.68438,-0.250626,-0.0634144,0.0979109,0.000573796,0.0241436,0.0472364,-0.112805,-0.234521,0.0358156,0.251318,0.0260126,0.28442,-0.00452562,-0.287025,-0.169853,-0.143814],
                 [-0.025587,-0.0304622,-0.019848,0.00775197,0.0438599,0.0655552,0.0357232,-0.0834601,-0.291157,0.522063,-0.385611,0.11506,-0.0356705,-0.00997116,-0.0290292,-0.131603,-0.246962,0.0996539,0.269413,-0.0971161,0.237726,-0.222622,-0.155458,-0.345962,0.204556],
                 [-0.0274149,-0.0583028,-0.0703964,-0.0512626,0.00160753,0.0715843,0.115704,0.0689882,-0.121749,-0.414091,0.438463,-0.229897,0.00783714,-0.0357272,-0.0714916,-0.157918,-0.256388,0.178322,0.247286,-0.231982,0.0610196,-0.378225,0.175163,-0.118108,0.313528],
                 [0.0292601,0.0496306,0.0508579,0.0260424,-0.0203925,-0.0668074,-0.0747879,-0.00714226,0.121161,0.159787,-0.18881,0.123543,0.00745149,0.0283836,0.0607445,-0.197388,-0.256258,0.271194,0.139763,-0.323706,-0.250365,-0.194391,0.387972,0.469089,-0.337172],
                 [-0.00850526,-0.0132702,-0.0125721,-0.00506975,0.00726503,0.0179673,0.0171443,-0.00233254,-0.0311569,-0.0298725,0.0365437,-0.0276619,-0.00328063,-0.00754826,-0.016591,-0.263162,-0.227511,0.364411,-0.137297,-0.226123,-0.477242,0.545046,-0.296213,-0.21732,0.104824],
                 [0.000853828,0.00126568,0.00113649,0.0003724,-0.000790322,-0.0017034,-0.00146737,0.000419259,0.00283934,0.00230801,-0.00283462,0.0023978,0.000384293,0.000725069,0.00161984,-0.394677,-0.101573,0.378214,-0.656583,0.347188,0.319246,-0.181739,0.0560036,0.0312121,-0.0113377],
                 [-1.94359e-05,-2.77737e-05,-2.39342e-05,-6.44145e-06,1.8764e-05,3.7076e-05,2.96615e-05,-1.17106e-05,-5.99093e-05,-4.40655e-05,5.35702e-05,-4.961e-05,-9.53326e-06,-1.60841e-05,-3.63513e-05,-0.788961,0.515447,-0.260925,0.201404,-0.0459005,-0.0310654,0.0115414,-0.0021446,-0.000973889,0.000278142]])
matrix = np.array([[1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168,0.0454525,0.0434764,0.0416649],
                   [0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168,0.0454525,0.0434764],
                   [0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168,0.0454525],
                   [0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975,0.0476168],
                   [0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288,0.0499975],
                   [0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525,0.0526288],
                   [0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201,0.0555525],
                   [0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961,0.0588201],
                   [0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622,0.0624961],
                   [0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235,0.0666622],
                   [0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172,0.0714235],
                   [0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264,0.0769172],
                   [0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008,0.0833264],
                   [0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999,0.0909008],
                   [0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099,0.09999],
                   [0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984,0.111099],
                   [0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837,0.124984],
                   [0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639,0.142837],
                   [0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996,0.166639],
                   [0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938,0.19996],
                   [0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222,0.249938],
                   [0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975,0.333222],
                   [0.0454525,0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001,0.49975],
                   [0.0434764,0.0454525,0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000,0.999001],
                   [0.0416649,0.0434764,0.0454525,0.0476168,0.0499975,0.0526288,0.0555525,0.0588201,0.0624961,0.0666622,0.0714235,0.0769172,0.0833264,0.0909008,0.09999,0.111099,0.124984,0.142837,0.166639,0.19996,0.249938,0.333222,0.49975,0.999001,1000]])


b = np.array([
    180428.94,
    84693.09  ,
    168169.28 ,
    171463.69 ,
    195774.78 ,
    42423.83  ,
    71988.54  ,
    164976.05 ,
    59651.66  ,
    118964.14 ,
    102520.24 ,
    135049.00 ,
    78336.87  ,
    110252.01 ,
    204489.78 ,
    196751.39 ,
    136518.05 ,
    154038.34 ,
    30408.92  ,
    130345.57 ,
    3500.52  ,
    52159.54  ,
    29470.26  ,
    172695.64 ,
    33646.58]).reshape(25,1)

print(Uc_U.T.dot(Vc_V))
print(np.linalg.solve(matrix, b))

N = 25
rank = 10
leftover = N - rank

new_mat = matrix
# new_mat = Uc_U.T.dot(matrix).dot(Vc_V)

p, Loo, Uoo = lu(new_mat[:leftover, :leftover], overwrite_a=True)
print(p)
new_mat[:leftover, leftover:] -= solve_triangular(Loo, new_mat[:leftover, leftover:], lower=True)
new_mat[leftover:, :leftover] -= solve_triangular(Uoo, new_mat[leftover:, :leftover].T, lower=False).T
new_mat[leftover:, leftover:] -= new_mat[leftover:, :leftover].dot(new_mat[:leftover, leftover:])

# y = Uc_U.T.dot(b)
y = b
y[:leftover] = solve_triangular(Loo, y[:leftover], lower=True)
y[leftover:] -= new_mat[leftover:, :leftover].dot(y[:leftover])
# y = piv.dot(y)

# y = piv.T.dot(y)
# y = Vc_V.dot(y)
y[:leftover] -= new_mat[:leftover, leftover:].dot(y[leftover:])
y[:leftover] = solve_triangular(Uoo, y[:leftover], lower=False)

print("from trisolve:")
print(y)

